"use strict";(()=>{var Di=Object.defineProperty;var qi=(i,t,e)=>t in i?Di(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var It=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var E=(i,t,e)=>(qi(i,typeof t!="symbol"?t+"":t,e),e);var ke=It(Ye=>{"use strict";var Ze={};Ye.default=function(i,t,e,n,r){var a=new Worker(Ze[t]||(Ze[t]=URL.createObjectURL(new Blob([i+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(s){var l=s.data,o=l.$e$;if(o){var f=new Error(o[0]);f.code=o[1],f.stack=o[2],r(f,null)}else r(null,l)},a.postMessage(e,n),a}});var Ci=It(I=>{"use strict";var Oi=ke(),D=Uint8Array,K=Uint16Array,Ct=Uint32Array,wt=new D([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Nt=new D([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gt=new D([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ve=function(i,t){for(var e=new K(31),n=0;n<31;++n)e[n]=t+=1<<i[n-1];for(var r=new Ct(e[30]),n=1;n<30;++n)for(var a=e[n];a<e[n+1];++a)r[a]=a-e[n]<<5|n;return[e,r]},He=Ve(wt,2),ye=He[0],Wt=He[1];ye[28]=258,Wt[258]=28;var Ke=Ve(Nt,0),Qe=Ke[0],pe=Ke[1],Lt=new K(32768);for(L=0;L<32768;++L)vt=(L&43690)>>>1|(L&21845)<<1,vt=(vt&52428)>>>2|(vt&13107)<<2,vt=(vt&61680)>>>4|(vt&3855)<<4,Lt[L]=((vt&65280)>>>8|(vt&255)<<8)>>>1;var vt,L,nt=function(i,t,e){for(var n=i.length,r=0,a=new K(t);r<n;++r)i[r]&&++a[i[r]-1];var s=new K(t);for(r=0;r<t;++r)s[r]=s[r-1]+a[r-1]<<1;var l;if(e){l=new K(1<<t);var o=15-t;for(r=0;r<n;++r)if(i[r])for(var f=r<<4|i[r],u=t-i[r],h=s[i[r]-1]++<<u,v=h|(1<<u)-1;h<=v;++h)l[Lt[h]>>>o]=f}else for(l=new K(n),r=0;r<n;++r)i[r]&&(l[r]=Lt[s[i[r]-1]++]>>>15-i[r]);return l},pt=new D(288);for(L=0;L<144;++L)pt[L]=8;var L;for(L=144;L<256;++L)pt[L]=9;var L;for(L=256;L<280;++L)pt[L]=7;var L;for(L=280;L<288;++L)pt[L]=8;var L,Tt=new D(32);for(L=0;L<32;++L)Tt[L]=5;var L,$e=nt(pt,9,0),We=nt(pt,9,1),Je=nt(Tt,5,0),ti=nt(Tt,5,1),Kt=function(i){for(var t=i[0],e=1;e<i.length;++e)i[e]>t&&(t=i[e]);return t},it=function(i,t,e){var n=t/8|0;return(i[n]|i[n+1]<<8)>>(t&7)&e},Qt=function(i,t){var e=t/8|0;return(i[e]|i[e+1]<<8|i[e+2]<<16)>>(t&7)},Zt=function(i){return(i+7)/8|0},rt=function(i,t,e){(t==null||t<0)&&(t=0),(e==null||e>i.length)&&(e=i.length);var n=new(i.BYTES_PER_ELEMENT==2?K:i.BYTES_PER_ELEMENT==4?Ct:D)(e-t);return n.set(i.subarray(t,e)),n};I.FlateErrorCode={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14};var ei=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_=function(i,t,e){var n=new Error(t||ei[i]);if(n.code=i,Error.captureStackTrace&&Error.captureStackTrace(n,_),!e)throw n;return n},Yt=function(i,t,e){var n=i.length;if(!n||e&&e.f&&!e.l)return t||new D(0);var r=!t||e,a=!e||e.i;e||(e={}),t||(t=new D(n*3));var s=function(Vt){var bt=t.length;if(Vt>bt){var xt=new D(Math.max(bt*2,Vt));xt.set(t),t=xt}},l=e.f||0,o=e.p||0,f=e.b||0,u=e.l,h=e.d,v=e.m,m=e.n,g=n*8;do{if(!u){l=it(i,o,1);var p=it(i,o+1,3);if(o+=3,p)if(p==1)u=We,h=ti,v=9,m=5;else if(p==2){var T=it(i,o,31)+257,x=it(i,o+10,15)+4,R=T+it(i,o+5,31)+1;o+=14;for(var O=new D(R),M=new D(19),d=0;d<x;++d)M[Gt[d]]=it(i,o+d*3,7);o+=x*3;for(var Y=Kt(M),N=(1<<Y)-1,V=nt(M,Y,1),d=0;d<R;){var z=V[it(i,o,N)];o+=z&15;var c=z>>>4;if(c<16)O[d++]=c;else{var C=0,F=0;for(c==16?(F=3+it(i,o,3),o+=2,C=O[d-1]):c==17?(F=3+it(i,o,7),o+=3):c==18&&(F=11+it(i,o,127),o+=7);F--;)O[d++]=C}}var G=O.subarray(0,T),B=O.subarray(T);v=Kt(G),m=Kt(B),u=nt(G,v,1),h=nt(B,m,1)}else _(1);else{var c=Zt(o)+4,y=i[c-4]|i[c-3]<<8,A=c+y;if(A>n){a&&_(0);break}r&&s(f+y),t.set(i.subarray(c,A),f),e.b=f+=y,e.p=o=A*8,e.f=l;continue}if(o>g){a&&_(0);break}}r&&s(f+131072);for(var P=(1<<v)-1,k=(1<<m)-1,X=o;;X=o){var C=u[Qt(i,o)&P],et=C>>>4;if(o+=C&15,o>g){a&&_(0);break}if(C||_(2),et<256)t[f++]=et;else if(et==256){X=o,u=null;break}else{var Q=et-254;if(et>264){var d=et-257,ot=wt[d];Q=it(i,o,(1<<ot)-1)+ye[d],o+=ot}var ft=h[Qt(i,o)&k],W=ft>>>4;ft||_(3),o+=ft&15;var B=Qe[W];if(W>3){var ot=Nt[W];B+=Qt(i,o)&(1<<ot)-1,o+=ot}if(o>g){a&&_(0);break}r&&s(f+131072);for(var H=f+Q;f<H;f+=4)t[f]=t[f-B],t[f+1]=t[f+1-B],t[f+2]=t[f+2-B],t[f+3]=t[f+3-B];f=H}}e.l=u,e.p=X,e.b=f,e.f=l,u&&(l=1,e.m=v,e.d=h,e.n=m)}while(!l);return f==t.length?t:rt(t,0,f)},ht=function(i,t,e){e<<=t&7;var n=t/8|0;i[n]|=e,i[n+1]|=e>>>8},Ut=function(i,t,e){e<<=t&7;var n=t/8|0;i[n]|=e,i[n+1]|=e>>>8,i[n+2]|=e>>>16},$t=function(i,t){for(var e=[],n=0;n<i.length;++n)i[n]&&e.push({s:n,f:i[n]});var r=e.length,a=e.slice();if(!r)return[gt,0];if(r==1){var s=new D(e[0].s+1);return s[e[0].s]=1,[s,1]}e.sort(function(R,O){return R.f-O.f}),e.push({s:-1,f:25001});var l=e[0],o=e[1],f=0,u=1,h=2;for(e[0]={s:-1,f:l.f+o.f,l,r:o};u!=r-1;)l=e[e[f].f<e[h].f?f++:h++],o=e[f!=u&&e[f].f<e[h].f?f++:h++],e[u++]={s:-1,f:l.f+o.f,l,r:o};for(var v=a[0].s,n=1;n<r;++n)a[n].s>v&&(v=a[n].s);var m=new K(v+1),g=Jt(e[u-1],m,0);if(g>t){var n=0,p=0,c=g-t,y=1<<c;for(a.sort(function(O,M){return m[M.s]-m[O.s]||O.f-M.f});n<r;++n){var A=a[n].s;if(m[A]>t)p+=y-(1<<g-m[A]),m[A]=t;else break}for(p>>>=c;p>0;){var T=a[n].s;m[T]<t?p-=1<<t-m[T]++-1:++n}for(;n>=0&&p;--n){var x=a[n].s;m[x]==t&&(--m[x],++p)}g=t}return[new D(m),g]},Jt=function(i,t,e){return i.s==-1?Math.max(Jt(i.l,t,e+1),Jt(i.r,t,e+1)):t[i.s]=e},de=function(i){for(var t=i.length;t&&!i[--t];);for(var e=new K(++t),n=0,r=i[0],a=1,s=function(o){e[n++]=o},l=1;l<=t;++l)if(i[l]==r&&l!=t)++a;else{if(!r&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(r),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(r);a=1,r=i[l]}return[e.subarray(0,n),t]},St=function(i,t){for(var e=0,n=0;n<t.length;++n)e+=i[n]*t[n];return e},te=function(i,t,e){var n=e.length,r=Zt(t+2);i[r]=n&255,i[r+1]=n>>>8,i[r+2]=i[r]^255,i[r+3]=i[r+1]^255;for(var a=0;a<n;++a)i[r+a+4]=e[a];return(r+4+n)*8},me=function(i,t,e,n,r,a,s,l,o,f,u){ht(t,u++,e),++r[256];for(var h=$t(r,15),v=h[0],m=h[1],g=$t(a,15),p=g[0],c=g[1],y=de(v),A=y[0],T=y[1],x=de(p),R=x[0],O=x[1],M=new K(19),d=0;d<A.length;++d)M[A[d]&31]++;for(var d=0;d<R.length;++d)M[R[d]&31]++;for(var Y=$t(M,7),N=Y[0],V=Y[1],z=19;z>4&&!N[Gt[z-1]];--z);var C=f+5<<3,F=St(r,pt)+St(a,Tt)+s,G=St(r,v)+St(a,p)+s+14+3*z+St(M,N)+(2*M[16]+3*M[17]+7*M[18]);if(C<=F&&C<=G)return te(t,u,i.subarray(o,o+f));var B,P,k,X;if(ht(t,u,1+(G<F)),u+=2,G<F){B=nt(v,m,0),P=v,k=nt(p,c,0),X=p;var et=nt(N,V,0);ht(t,u,T-257),ht(t,u+5,O-1),ht(t,u+10,z-4),u+=14;for(var d=0;d<z;++d)ht(t,u+3*d,N[Gt[d]]);u+=3*z;for(var Q=[A,R],ot=0;ot<2;++ot)for(var ft=Q[ot],d=0;d<ft.length;++d){var W=ft[d]&31;ht(t,u,et[W]),u+=N[W],W>15&&(ht(t,u,ft[d]>>>5&127),u+=ft[d]>>>12)}}else B=$e,P=pt,k=Je,X=Tt;for(var d=0;d<l;++d)if(n[d]>255){var W=n[d]>>>18&31;Ut(t,u,B[W+257]),u+=P[W+257],W>7&&(ht(t,u,n[d]>>>23&31),u+=wt[W]);var H=n[d]&31;Ut(t,u,k[H]),u+=X[H],H>3&&(Ut(t,u,n[d]>>>5&8191),u+=Nt[H])}else Ut(t,u,B[n[d]]),u+=P[n[d]];return Ut(t,u,B[256]),u+P[256]},ii=new Ct([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),gt=new D(0),ni=function(i,t,e,n,r,a){var s=i.length,l=new D(n+s+5*(1+Math.ceil(s/7e3))+r),o=l.subarray(n,l.length-r),f=0;if(!t||s<8)for(var u=0;u<=s;u+=65535){var h=u+65535;h>=s&&(o[f>>3]=a),f=te(o,f+1,i.subarray(u,h))}else{for(var v=ii[t-1],m=v>>>13,g=v&8191,p=(1<<e)-1,c=new K(32768),y=new K(p+1),A=Math.ceil(e/3),T=2*A,x=function(ve){return(i[ve]^i[ve+1]<<A^i[ve+2]<<T)&p},R=new Ct(25e3),O=new K(288),M=new K(32),d=0,Y=0,u=0,N=0,V=0,z=0;u<s;++u){var C=x(u),F=u&32767,G=y[C];if(c[F]=G,y[C]=F,V<=u){var B=s-u;if((d>7e3||N>24576)&&B>423){f=me(i,o,0,R,O,M,Y,N,z,u-z,f),N=d=Y=0,z=u;for(var P=0;P<286;++P)O[P]=0;for(var P=0;P<30;++P)M[P]=0}var k=2,X=0,et=g,Q=F-G&32767;if(B>2&&C==x(u-Q))for(var ot=Math.min(m,B)-1,ft=Math.min(32767,u),W=Math.min(258,B);Q<=ft&&--et&&F!=G;){if(i[u+k]==i[u+k-Q]){for(var H=0;H<W&&i[u+H]==i[u+H-Q];++H);if(H>k){if(k=H,X=Q,H>ot)break;for(var Vt=Math.min(Q,H-2),bt=0,P=0;P<Vt;++P){var xt=u-Q+P+32768&32767,zi=c[xt],Ge=xt-zi+32768&32767;Ge>bt&&(bt=Ge,G=xt)}}}F=G,G=c[F],Q+=F-G+32768&32767}if(X){R[N++]=268435456|Wt[k]<<18|pe[X];var Le=Wt[k]&31,Re=pe[X]&31;Y+=wt[Le]+Nt[Re],++O[257+Le],++M[Re],V=u+k,++d}else R[N++]=i[u],++O[i[u]]}}f=me(i,o,a,R,O,M,Y,N,z,u-z,f),!a&&f&7&&(f=te(o,f+1,gt))}return rt(l,0,n+Zt(f)+r)},ri=function(){for(var i=new Int32Array(256),t=0;t<256;++t){for(var e=t,n=9;--n;)e=(e&1&&-306674912)^e>>>1;i[t]=e}return i}(),Ft=function(){var i=-1;return{p:function(t){for(var e=i,n=0;n<t.length;++n)e=ri[e&255^t[n]]^e>>>8;i=e},d:function(){return~i}}},Ae=function(){var i=1,t=0;return{p:function(e){for(var n=i,r=t,a=e.length|0,s=0;s!=a;){for(var l=Math.min(s+2655,a);s<l;++s)r+=n+=e[s];n=(n&65535)+15*(n>>16),r=(r&65535)+15*(r>>16)}i=n,t=r},d:function(){return i%=65521,t%=65521,(i&255)<<24|i>>>8<<16|(t&255)<<8|t>>>8}}},yt=function(i,t,e,n,r){return ni(i,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):12+t.mem,e,n,!r)},kt=function(i,t){var e={};for(var n in i)e[n]=i[n];for(var n in t)e[n]=t[n];return e},Xe=function(i,t,e){for(var n=i(),r=i.toString(),a=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/\s+/g,"").split(","),s=0;s<n.length;++s){var l=n[s],o=a[s];if(typeof l=="function"){t+=";"+o+"=";var f=l.toString();if(l.prototype)if(f.indexOf("[native code]")!=-1){var u=f.indexOf(" ",8)+1;t+=f.slice(u,f.indexOf("(",u))}else{t+=f;for(var h in l.prototype)t+=";"+o+".prototype."+h+"="+l.prototype[h].toString()}else t+=f}else e[o]=l}return[t,e]},Ht=[],Bi=function(i){var t=[];for(var e in i)i[e].buffer&&t.push((i[e]=new i[e].constructor(i[e])).buffer);return t},si=function(i,t,e,n){var r;if(!Ht[e]){for(var a="",s={},l=i.length-1,o=0;o<l;++o)r=Xe(i[o],a,s),a=r[0],s=r[1];Ht[e]=Xe(i[l],a,s)}var f=kt({},Ht[e][1]);return Oi.default(Ht[e][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",e,f,Bi(f),n)},zt=function(){return[D,K,Ct,wt,Nt,Gt,ye,Qe,We,ti,Lt,ei,nt,Kt,it,Qt,Zt,rt,_,Yt,Bt,_t,xe]},Dt=function(){return[D,K,Ct,wt,Nt,Gt,Wt,pe,$e,pt,Je,Tt,Lt,ii,gt,nt,ht,Ut,$t,Jt,de,St,te,me,Zt,rt,ni,yt,Xt,_t]},ai=function(){return[Ue,Te,Z,Ft,ri]},oi=function(){return[Se,hi]},li=function(){return[Me,Z,Ae]},fi=function(){return[ui]},_t=function(i){return postMessage(i,[i.buffer])},xe=function(i){return i&&i.size&&new D(i.size)},qt=function(i,t,e,n,r,a){var s=si(e,n,r,function(l,o){s.terminate(),a(l,o)});return s.postMessage([i,t],t.consume?[i.buffer]:[]),function(){s.terminate()}},st=function(i){return i.ondata=function(t,e){return postMessage([t,e],[t.buffer])},function(t){return i.push(t.data[0],t.data[1])}},Ot=function(i,t,e,n,r){var a,s=si(i,n,r,function(l,o){l?(s.terminate(),t.ondata.call(t,l)):(o[1]&&s.terminate(),t.ondata.call(t,l,o[0],o[1]))});s.postMessage(e),t.push=function(l,o){t.ondata||_(5),a&&t.ondata(_(4,0,1),null,!!o),s.postMessage([l,a=o],[l.buffer])},t.terminate=function(){s.terminate()}},$=function(i,t){return i[t]|i[t+1]<<8},j=function(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16|i[t+3]<<24)>>>0},ge=function(i,t){return j(i,t)+j(i,t+4)*4294967296},Z=function(i,t,e){for(;e;++t)i[t]=e,e>>>=8},Ue=function(i,t){var e=t.filename;if(i[0]=31,i[1]=139,i[2]=8,i[8]=t.level<2?4:t.level==9?2:0,i[9]=3,t.mtime!=0&&Z(i,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),e){i[3]=8;for(var n=0;n<=e.length;++n)i[n+10]=e.charCodeAt(n)}},Se=function(i){(i[0]!=31||i[1]!=139||i[2]!=8)&&_(6,"invalid gzip data");var t=i[3],e=10;t&4&&(e+=i[10]|(i[11]<<8)+2);for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!i[e++]);return e+(t&2)},hi=function(i){var t=i.length;return(i[t-4]|i[t-3]<<8|i[t-2]<<16|i[t-1]<<24)>>>0},Te=function(i){return 10+(i.filename&&i.filename.length+1||0)},Me=function(i,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;i[0]=120,i[1]=n<<6|(n?32-2*n:1)},ui=function(i){((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)&&_(6,"invalid zlib data"),i[1]&32&&_(6,"invalid zlib data: preset dictionaries not supported")};function Ce(i,t){return!t&&typeof i=="function"&&(t=i,i={}),this.ondata=t,i}var ut=function(){function i(t,e){!e&&typeof t=="function"&&(e=t,t={}),this.ondata=e,this.o=t||{}}return i.prototype.p=function(t,e){this.ondata(yt(t,this.o,0,0,!e),e)},i.prototype.push=function(t,e){this.ondata||_(5),this.d&&_(4),this.d=e,this.p(t,e||!1)},i}();I.Deflate=ut;var ci=function(){function i(t,e){Ot([Dt,function(){return[st,ut]}],this,Ce.call(this,t,e),function(n){var r=new ut(n.data);onmessage=st(r)},6)}return i}();I.AsyncDeflate=ci;function vi(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),qt(i,t,[Dt],function(n){return _t(Xt(n.data[0],n.data[1]))},0,e)}I.deflate=vi;function Xt(i,t){return yt(i,t||{},0,0)}I.deflateSync=Xt;var J=function(){function i(t){this.s={},this.p=new D(0),this.ondata=t}return i.prototype.e=function(t){this.ondata||_(5),this.d&&_(4);var e=this.p.length,n=new D(e+t.length);n.set(this.p),n.set(t,e),this.p=n},i.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,n=Yt(this.p,this.o,this.s);this.ondata(rt(n,e,this.s.b),this.d),this.o=rt(n,this.s.b-32768),this.s.b=this.o.length,this.p=rt(this.p,this.s.p/8|0),this.s.p&=7},i.prototype.push=function(t,e){this.e(t),this.c(e)},i}();I.Inflate=J;var we=function(){function i(t){this.ondata=t,Ot([zt,function(){return[st,J]}],this,0,function(){var e=new J;onmessage=st(e)},7)}return i}();I.AsyncInflate=we;function Ne(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),qt(i,t,[zt],function(n){return _t(Bt(n.data[0],xe(n.data[1])))},1,e)}I.inflate=Ne;function Bt(i,t){return Yt(i,t)}I.inflateSync=Bt;var ee=function(){function i(t,e){this.c=Ft(),this.l=0,this.v=1,ut.call(this,t,e)}return i.prototype.push=function(t,e){ut.prototype.push.call(this,t,e)},i.prototype.p=function(t,e){this.c.p(t),this.l+=t.length;var n=yt(t,this.o,this.v&&Te(this.o),e&&8,!e);this.v&&(Ue(n,this.o),this.v=0),e&&(Z(n,n.length-8,this.c.d()),Z(n,n.length-4,this.l)),this.ondata(n,e)},i}();I.Gzip=ee;I.Compress=ee;var gi=function(){function i(t,e){Ot([Dt,ai,function(){return[st,ut,ee]}],this,Ce.call(this,t,e),function(n){var r=new ee(n.data);onmessage=st(r)},8)}return i}();I.AsyncGzip=gi;I.AsyncCompress=gi;function pi(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),qt(i,t,[Dt,ai,function(){return[ie]}],function(n){return _t(ie(n.data[0],n.data[1]))},2,e)}I.gzip=pi;I.compress=pi;function ie(i,t){t||(t={});var e=Ft(),n=i.length;e.p(i);var r=yt(i,t,Te(t),8),a=r.length;return Ue(r,t),Z(r,a-8,e.d()),Z(r,a-4,n),r}I.gzipSync=ie;I.compressSync=ie;var ne=function(){function i(t){this.v=1,J.call(this,t)}return i.prototype.push=function(t,e){if(J.prototype.e.call(this,t),this.v){var n=this.p.length>3?Se(this.p):4;if(n>=this.p.length&&!e)return;this.p=this.p.subarray(n),this.v=0}e&&(this.p.length<8&&_(6,"invalid gzip data"),this.p=this.p.subarray(0,-8)),J.prototype.c.call(this,e)},i}();I.Gunzip=ne;var di=function(){function i(t){this.ondata=t,Ot([zt,oi,function(){return[st,J,ne]}],this,0,function(){var e=new ne;onmessage=st(e)},9)}return i}();I.AsyncGunzip=di;function mi(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),qt(i,t,[zt,oi,function(){return[re]}],function(n){return _t(re(n.data[0]))},3,e)}I.gunzip=mi;function re(i,t){return Yt(i.subarray(Se(i),-8),t||new D(hi(i)))}I.gunzipSync=re;var _e=function(){function i(t,e){this.c=Ae(),this.v=1,ut.call(this,t,e)}return i.prototype.push=function(t,e){ut.prototype.push.call(this,t,e)},i.prototype.p=function(t,e){this.c.p(t);var n=yt(t,this.o,this.v&&2,e&&4,!e);this.v&&(Me(n,this.o),this.v=0),e&&Z(n,n.length-4,this.c.d()),this.ondata(n,e)},i}();I.Zlib=_e;var Pi=function(){function i(t,e){Ot([Dt,li,function(){return[st,ut,_e]}],this,Ce.call(this,t,e),function(n){var r=new _e(n.data);onmessage=st(r)},10)}return i}();I.AsyncZlib=Pi;function bi(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),qt(i,t,[Dt,li,function(){return[Ee]}],function(n){return _t(Ee(n.data[0],n.data[1]))},4,e)}I.zlib=bi;function Ee(i,t){t||(t={});var e=Ae();e.p(i);var n=yt(i,t,2,4);return Me(n,t),Z(n,n.length-4,e.d()),n}I.zlibSync=Ee;var se=function(){function i(t){this.v=1,J.call(this,t)}return i.prototype.push=function(t,e){if(J.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}e&&(this.p.length<4&&_(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),J.prototype.c.call(this,e)},i}();I.Unzlib=se;var _i=function(){function i(t){this.ondata=t,Ot([zt,fi,function(){return[st,J,se]}],this,0,function(){var e=new se;onmessage=st(e)},11)}return i}();I.AsyncUnzlib=_i;function Ei(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),qt(i,t,[zt,fi,function(){return[ae]}],function(n){return _t(ae(n.data[0],xe(n.data[1])))},5,e)}I.unzlib=Ei;function ae(i,t){return Yt((ui(i),i.subarray(2,-4)),t)}I.unzlibSync=ae;var Ii=function(){function i(t){this.G=ne,this.I=J,this.Z=se,this.ondata=t}return i.prototype.push=function(t,e){if(this.ondata||_(5),this.s)this.s.push(t,e);else{if(this.p&&this.p.length){var n=new D(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length)}else this.p=t;if(this.p.length>2){var r=this,a=function(){r.ondata.apply(r,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(a):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(a):new this.Z(a),this.s.push(this.p,e),this.p=null}}},i}();I.Decompress=Ii;var Gi=function(){function i(t){this.G=di,this.I=we,this.Z=_i,this.ondata=t}return i.prototype.push=function(t,e){Ii.prototype.push.call(this,t,e)},i}();I.AsyncDecompress=Gi;function Li(i,t,e){return e||(e=t,t={}),typeof e!="function"&&_(7),i[0]==31&&i[1]==139&&i[2]==8?mi(i,t,e):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?Ne(i,t,e):Ei(i,t,e)}I.decompress=Li;function Ri(i,t){return i[0]==31&&i[1]==139&&i[2]==8?re(i,t):(i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31?Bt(i,t):ae(i,t)}I.decompressSync=Ri;var Fe=function(i,t,e,n){for(var r in i){var a=i[r],s=t+r,l=n;Array.isArray(a)&&(l=kt(n,a[1]),a=a[0]),a instanceof D?e[s]=[a,l]:(e[s+="/"]=[new D(0),l],Fe(a,s,e,n))}},je=typeof TextEncoder<"u"&&new TextEncoder,Ie=typeof TextDecoder<"u"&&new TextDecoder,yi=0;try{Ie.decode(gt,{stream:!0}),yi=1}catch{}var Ai=function(i){for(var t="",e=0;;){var n=i[e++],r=(n>127)+(n>223)+(n>239);if(e+r>i.length)return[t,rt(i,e-1)];r?r==3?(n=((n&15)<<18|(i[e++]&63)<<12|(i[e++]&63)<<6|i[e++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):r&1?t+=String.fromCharCode((n&31)<<6|i[e++]&63):t+=String.fromCharCode((n&15)<<12|(i[e++]&63)<<6|i[e++]&63):t+=String.fromCharCode(n)}},Zi=function(){function i(t){this.ondata=t,yi?this.t=new TextDecoder:this.p=gt}return i.prototype.push=function(t,e){if(this.ondata||_(5),e=!!e,this.t){this.ondata(this.t.decode(t,{stream:!0}),e),e&&(this.t.decode().length&&_(8),this.t=null);return}this.p||_(4);var n=new D(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length);var r=Ai(n),a=r[0],s=r[1];e?(s.length&&_(8),this.p=null):this.p=s,this.ondata(a,e)},i}();I.DecodeUTF8=Zi;var Yi=function(){function i(t){this.ondata=t}return i.prototype.push=function(t,e){this.ondata||_(5),this.d&&_(4),this.ondata(mt(t),this.d=e||!1)},i}();I.EncodeUTF8=Yi;function mt(i,t){if(t){for(var e=new D(i.length),n=0;n<i.length;++n)e[n]=i.charCodeAt(n);return e}if(je)return je.encode(i);for(var r=i.length,a=new D(i.length+(i.length>>1)),s=0,l=function(u){a[s++]=u},n=0;n<r;++n){if(s+5>a.length){var o=new D(s+8+(r-n<<1));o.set(a),a=o}var f=i.charCodeAt(n);f<128||t?l(f):f<2048?(l(192|f>>6),l(128|f&63)):f>55295&&f<57344?(f=65536+(f&1023<<10)|i.charCodeAt(++n)&1023,l(240|f>>18),l(128|f>>12&63),l(128|f>>6&63),l(128|f&63)):(l(224|f>>12),l(128|f>>6&63),l(128|f&63))}return rt(a,0,s)}I.strToU8=mt;function ze(i,t){if(t){for(var e="",n=0;n<i.length;n+=16384)e+=String.fromCharCode.apply(null,i.subarray(n,n+16384));return e}else{if(Ie)return Ie.decode(i);var r=Ai(i),a=r[0],s=r[1];return s.length&&_(8),a}}I.strFromU8=ze;var xi=function(i){return i==1?3:i<6?2:i==9?1:0},Ui=function(i,t){return t+30+$(i,t+26)+$(i,t+28)},Si=function(i,t,e){var n=$(i,t+28),r=ze(i.subarray(t+46,t+46+n),!($(i,t+8)&2048)),a=t+46+n,s=j(i,t+20),l=e&&s==4294967295?Ti(i,a):[s,j(i,t+24),j(i,t+42)],o=l[0],f=l[1],u=l[2];return[$(i,t+10),o,f,r,a+$(i,t+30)+$(i,t+32),u]},Ti=function(i,t){for(;$(i,t)!=1;t+=4+$(i,t+2));return[ge(i,t+12),ge(i,t+4),ge(i,t+20)]},dt=function(i){var t=0;if(i)for(var e in i){var n=i[e].length;n>65535&&_(9),t+=n+4}return t},Mt=function(i,t,e,n,r,a,s,l){var o=n.length,f=e.extra,u=l&&l.length,h=dt(f);Z(i,t,s!=null?33639248:67324752),t+=4,s!=null&&(i[t++]=20,i[t++]=e.os),i[t]=20,t+=2,i[t++]=e.flag<<1|(a==null&&8),i[t++]=r&&8,i[t++]=e.compression&255,i[t++]=e.compression>>8;var v=new Date(e.mtime==null?Date.now():e.mtime),m=v.getFullYear()-1980;if((m<0||m>119)&&_(10),Z(i,t,m<<25|v.getMonth()+1<<21|v.getDate()<<16|v.getHours()<<11|v.getMinutes()<<5|v.getSeconds()>>>1),t+=4,a!=null&&(Z(i,t,e.crc),Z(i,t+4,a),Z(i,t+8,e.size)),Z(i,t+12,o),Z(i,t+14,h),t+=16,s!=null&&(Z(i,t,u),Z(i,t+6,e.attrs),Z(i,t+10,s),t+=14),i.set(n,t),t+=o,h)for(var g in f){var p=f[g],c=p.length;Z(i,t,+g),Z(i,t+2,c),i.set(p,t+4),t+=4+c}return u&&(i.set(l,t),t+=u),t},De=function(i,t,e,n,r){Z(i,t,101010256),Z(i,t+8,e),Z(i,t+10,e),Z(i,t+12,n),Z(i,t+16,r)},Rt=function(){function i(t){this.filename=t,this.c=Ft(),this.size=0,this.compression=0}return i.prototype.process=function(t,e){this.ondata(null,t,e)},i.prototype.push=function(t,e){this.ondata||_(5),this.c.p(t),this.size+=t.length,e&&(this.crc=this.c.d()),this.process(t,e||!1)},i}();I.ZipPassThrough=Rt;var ki=function(){function i(t,e){var n=this;e||(e={}),Rt.call(this,t),this.d=new ut(e,function(r,a){n.ondata(null,r,a)}),this.compression=8,this.flag=xi(e.level)}return i.prototype.process=function(t,e){try{this.d.push(t,e)}catch(n){this.ondata(n,null,e)}},i.prototype.push=function(t,e){Rt.prototype.push.call(this,t,e)},i}();I.ZipDeflate=ki;var Xi=function(){function i(t,e){var n=this;e||(e={}),Rt.call(this,t),this.d=new ci(e,function(r,a,s){n.ondata(r,a,s)}),this.compression=8,this.flag=xi(e.level),this.terminate=this.d.terminate}return i.prototype.process=function(t,e){this.d.push(t,e)},i.prototype.push=function(t,e){Rt.prototype.push.call(this,t,e)},i}();I.AsyncZipDeflate=Xi;var ji=function(){function i(t){this.ondata=t,this.u=[],this.d=1}return i.prototype.add=function(t){var e=this;if(this.ondata||_(5),this.d&2)this.ondata(_(4+(this.d&1)*8,0,1),null,!1);else{var n=mt(t.filename),r=n.length,a=t.comment,s=a&&mt(a),l=r!=t.filename.length||s&&a.length!=s.length,o=r+dt(t.extra)+30;r>65535&&this.ondata(_(11,0,1),null,!1);var f=new D(o);Mt(f,0,t,n,l);var u=[f],h=function(){for(var c=0,y=u;c<y.length;c++){var A=y[c];e.ondata(null,A,!1)}u=[]},v=this.d;this.d=0;var m=this.u.length,g=kt(t,{f:n,u:l,o:s,t:function(){t.terminate&&t.terminate()},r:function(){if(h(),v){var c=e.u[m+1];c?c.r():e.d=1}v=1}}),p=0;t.ondata=function(c,y,A){if(c)e.ondata(c,y,A),e.terminate();else if(p+=y.length,u.push(y),A){var T=new D(16);Z(T,0,134695760),Z(T,4,t.crc),Z(T,8,p),Z(T,12,t.size),u.push(T),g.c=p,g.b=o+p+16,g.crc=t.crc,g.size=t.size,v&&g.r(),v=1}else v&&h()},this.u.push(g)}},i.prototype.end=function(){var t=this;if(this.d&2){this.ondata(_(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){t.d&1&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3},i.prototype.e=function(){for(var t=0,e=0,n=0,r=0,a=this.u;r<a.length;r++){var s=a[r];n+=46+s.f.length+dt(s.extra)+(s.o?s.o.length:0)}for(var l=new D(n+22),o=0,f=this.u;o<f.length;o++){var s=f[o];Mt(l,t,s,s.f,s.u,s.c,e,s.o),t+=46+s.f.length+dt(s.extra)+(s.o?s.o.length:0),e+=s.b}De(l,t,this.u.length,n,e),this.ondata(null,l,!0),this.d=2},i.prototype.terminate=function(){for(var t=0,e=this.u;t<e.length;t++){var n=e[t];n.t()}this.d=2},i}();I.Zip=ji;function Vi(i,t,e){e||(e=t,t={}),typeof e!="function"&&_(7);var n={};Fe(i,"",n,t);var r=Object.keys(n),a=r.length,s=0,l=0,o=a,f=new Array(a),u=[],h=function(){for(var c=0;c<u.length;++c)u[c]()},v=function(c,y){oe(function(){e(c,y)})};oe(function(){v=e});var m=function(){var c=new D(l+22),y=s,A=l-s;l=0;for(var T=0;T<o;++T){var x=f[T];try{var R=x.c.length;Mt(c,l,x,x.f,x.u,R);var O=30+x.f.length+dt(x.extra),M=l+O;c.set(x.c,M),Mt(c,s,x,x.f,x.u,R,l,x.m),s+=16+O+(x.m?x.m.length:0),l=M+R}catch(d){return v(d,null)}}De(c,s,f.length,A,y),v(null,c)};a||m();for(var g=function(c){var y=r[c],A=n[y],T=A[0],x=A[1],R=Ft(),O=T.length;R.p(T);var M=mt(y),d=M.length,Y=x.comment,N=Y&&mt(Y),V=N&&N.length,z=dt(x.extra),C=x.level==0?0:8,F=function(G,B){if(G)h(),v(G,null);else{var P=B.length;f[c]=kt(x,{size:O,crc:R.d(),c:B,f:M,m:N,u:d!=y.length||N&&Y.length!=V,compression:C}),s+=30+d+z+P,l+=76+2*(d+z)+(V||0)+P,--a||m()}};if(d>65535&&F(_(11,0,1),null),!C)F(null,T);else if(O<16e4)try{F(null,Xt(T,x))}catch(G){F(G,null)}else u.push(vi(T,x,F))},p=0;p<o;++p)g(p);return h}I.zip=Vi;function Hi(i,t){t||(t={});var e={},n=[];Fe(i,"",e,t);var r=0,a=0;for(var s in e){var l=e[s],o=l[0],f=l[1],u=f.level==0?0:8,h=mt(s),v=h.length,m=f.comment,g=m&&mt(m),p=g&&g.length,c=dt(f.extra);v>65535&&_(11);var y=u?Xt(o,f):o,A=y.length,T=Ft();T.p(o),n.push(kt(f,{size:o.length,crc:T.d(),c:y,f:h,m:g,u:v!=s.length||g&&m.length!=p,o:r,compression:u})),r+=30+v+c+A,a+=76+2*(v+c)+(p||0)+A}for(var x=new D(a+22),R=r,O=a-r,M=0;M<n.length;++M){var h=n[M];Mt(x,h.o,h,h.f,h.u,h.c.length);var d=30+h.f.length+dt(h.extra);x.set(h.c,h.o+d),Mt(x,r,h,h.f,h.u,h.c.length,h.o,h.m),r+=16+d+(h.m?h.m.length:0)}return De(x,r,n.length,O,R),x}I.zipSync=Hi;var Mi=function(){function i(){}return i.prototype.push=function(t,e){this.ondata(null,t,e)},i.compression=0,i}();I.UnzipPassThrough=Mi;var Ki=function(){function i(){var t=this;this.i=new J(function(e,n){t.ondata(null,e,n)})}return i.prototype.push=function(t,e){try{this.i.push(t,e)}catch(n){this.ondata(n,null,e)}},i.compression=8,i}();I.UnzipInflate=Ki;var Qi=function(){function i(t,e){var n=this;e<32e4?this.i=new J(function(r,a){n.ondata(null,r,a)}):(this.i=new we(function(r,a,s){n.ondata(r,a,s)}),this.terminate=this.i.terminate)}return i.prototype.push=function(t,e){this.i.terminate&&(t=rt(t,0)),this.i.push(t,e)},i.compression=8,i}();I.AsyncUnzipInflate=Qi;var $i=function(){function i(t){this.onfile=t,this.k=[],this.o={0:Mi},this.p=gt}return i.prototype.push=function(t,e){var n=this;if(this.onfile||_(5),this.p||_(4),this.c>0){var r=Math.min(this.c,t.length),a=t.subarray(0,r);if(this.c-=r,this.d?this.d.push(a,!this.c):this.k[0].push(a),t=t.subarray(r),t.length)return this.push(t,e)}else{var s=0,l=0,o=void 0,f=void 0;this.p.length?t.length?(f=new D(this.p.length+t.length),f.set(this.p),f.set(t,this.p.length)):f=this.p:f=t;for(var u=f.length,h=this.c,v=h&&this.d,m=function(){var y,A=j(f,l);if(A==67324752){s=1,o=l,g.d=null,g.c=0;var T=$(f,l+6),x=$(f,l+8),R=T&2048,O=T&8,M=$(f,l+26),d=$(f,l+28);if(u>l+30+M+d){var Y=[];g.k.unshift(Y),s=2;var N=j(f,l+18),V=j(f,l+22),z=ze(f.subarray(l+30,l+=30+M),!R);N==4294967295?(y=O?[-2]:Ti(f,l),N=y[0],V=y[1]):O&&(N=-1),l+=d,g.c=N;var C,F={name:z,compression:x,start:function(){if(F.ondata||_(5),!N)F.ondata(null,gt,!0);else{var G=n.o[x];G||F.ondata(_(14,"unknown compression type "+x,1),null,!1),C=N<0?new G(z):new G(z,N,V),C.ondata=function(X,et,Q){F.ondata(X,et,Q)};for(var B=0,P=Y;B<P.length;B++){var k=P[B];C.push(k,!1)}n.k[0]==Y&&n.c?n.d=C:C.push(gt,!0)}},terminate:function(){C&&C.terminate&&C.terminate()}};N>=0&&(F.size=N,F.originalSize=V),g.onfile(F)}return"break"}else if(h){if(A==134695760)return o=l+=12+(h==-2&&8),s=3,g.c=0,"break";if(A==33639248)return o=l-=4,s=3,g.c=0,"break"}},g=this;l<u-4;++l){var p=m();if(p==="break")break}if(this.p=gt,h<0){var c=s?f.subarray(0,o-12-(h==-2&&8)-(j(f,o-16)==134695760&&4)):f.subarray(0,l);v?v.push(c,!!s):this.k[+(s==2)].push(c)}if(s&2)return this.push(f.subarray(l),e);this.p=f.subarray(l)}e&&(this.c&&_(13),this.p=null)},i.prototype.register=function(t){this.o[t.compression]=t},i}();I.Unzip=$i;var oe=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(i){i()};function Wi(i,t,e){e||(e=t,t={}),typeof e!="function"&&_(7);var n=[],r=function(){for(var p=0;p<n.length;++p)n[p]()},a={},s=function(p,c){oe(function(){e(p,c)})};oe(function(){s=e});for(var l=i.length-22;j(i,l)!=101010256;--l)if(!l||i.length-l>65558)return s(_(13,0,1),null),r;var o=$(i,l+8);if(o){var f=o,u=j(i,l+16),h=u==4294967295;if(h){if(l=j(i,l-12),j(i,l)!=101075792)return s(_(13,0,1),null),r;f=o=j(i,l+32),u=j(i,l+48)}for(var v=t&&t.filter,m=function(p){var c=Si(i,u,h),y=c[0],A=c[1],T=c[2],x=c[3],R=c[4],O=c[5],M=Ui(i,O);u=R;var d=function(N,V){N?(r(),s(N,null)):(V&&(a[x]=V),--o||s(null,a))};if(!v||v({name:x,size:A,originalSize:T,compression:y}))if(!y)d(null,rt(i,M,M+A));else if(y==8){var Y=i.subarray(M,M+A);if(A<32e4)try{d(null,Bt(Y,new D(T)))}catch(N){d(N,null)}else n.push(Ne(Y,{size:T},d))}else d(_(14,"unknown compression type "+y,1),null);else d(null,null)},g=0;g<f;++g)m(g)}else s(null,{});return r}I.unzip=Wi;function Ji(i,t){for(var e={},n=i.length-22;j(i,n)!=101010256;--n)(!n||i.length-n>65558)&&_(13);var r=$(i,n+8);if(!r)return{};var a=j(i,n+16),s=a==4294967295;s&&(n=j(i,n-12),j(i,n)!=101075792&&_(13),r=j(i,n+32),a=j(i,n+48));for(var l=t&&t.filter,o=0;o<r;++o){var f=Si(i,a,s),u=f[0],h=f[1],v=f[2],m=f[3],g=f[4],p=f[5],c=Ui(i,p);a=g,(!l||l({name:m,size:h,originalSize:v,compression:u}))&&(u?u==8?e[m]=Bt(i.subarray(c,c+h),new D(v)):_(14,"unknown compression type "+u):e[m]=rt(i,c,c+h))}return e}I.unzipSync=Ji});var Oe=It(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.NIFTIEXTENSION=void 0;var qe=class{esize;ecode;edata;littleEndian;constructor(t,e,n,r){if(t%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=t,this.ecode=e,this.edata=n,this.littleEndian=r}toArrayBuffer(){let t=new Uint8Array(this.esize),e=new Uint8Array(this.edata);t.set(e,8);let n=new DataView(t.buffer);return n.setInt32(0,this.esize,this.littleEndian),n.setInt32(4,this.ecode,this.littleEndian),t.buffer}};le.NIFTIEXTENSION=qe});var jt=It(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.Utils=void 0;var tn=Oe(),lt=class{static getStringAt(t,e,n){var r="",a,s;for(a=e;a<n;a+=1)s=t.getUint8(a),s!==0&&(r+=String.fromCharCode(s));return r}static getIntAt(t,e,n){return t.getInt32(e,n)}static getFloatAt(t,e,n){return t.getFloat32(e,n)}static getDoubleAt(t,e,n){return t.getFloat64(e,n)}static getLongAt(t,e,n){var r,a=[],s=0;for(r=0;r<8;r+=1)a[r]=lt.getByteAt(t,e+r);for(r=a.length-1;r>=0;r--)s=s*256+a[r];return s}static getExtensionsAt(t,e,n,r){let a=[],s=e;for(;s<r;){let l=n,o=lt.getIntAt(t,s,n);if(!o)break;if(o+s>r&&(l=!l,o=lt.getIntAt(t,s,l),o+s>r))throw new Error("This does not appear to be a valid NIFTI extension");if(o%16!=0)throw new Error("This does not appear to be a NIFTI extension");let f=lt.getIntAt(t,s+4,l),u=t.buffer.slice(s+8,s+o);console.log("extensionByteIndex: "+(s+8)+" esize: "+o),console.log(u);let h=new tn.NIFTIEXTENSION(o,f,u,l);a.push(h),s+=o}return a}static toArrayBuffer(t){var e,n,r;for(e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r<t.length;r+=1)n[r]=t[r];return e}static isString(t){return typeof t=="string"||t instanceof String}static formatNumber(t,e=void 0){let n;return lt.isString(t)?n=Number(t):n=t,e?n=n.toPrecision(5):n=n.toPrecision(7),parseFloat(n)}static makeCRCTable(){let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e}static crc32(t){lt.crcTable||(lt.crcTable=lt.makeCRCTable());let e=lt.crcTable,n=-1;for(var r=0;r<t.byteLength;r++)n=n>>>8^e[(n^t.getUint8(r))&255];return(n^-1)>>>0}},Et=lt;E(Et,"crcTable",null),E(Et,"GUNZIP_MAGIC_COOKIE1",31),E(Et,"GUNZIP_MAGIC_COOKIE2",139),E(Et,"getByteAt",function(t,e){return t.getInt8(e)}),E(Et,"getShortAt",function(t,e,n){return t.getInt16(e,n)});fe.Utils=Et});var ue=It(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.NIFTI1=void 0;var U=jt(),b=class{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_a=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];qfac=1;quatern_R;magic="0";isHDR=!1;extensionFlag=[0,0,0,0];extensionSize=0;extensionCode=0;extensions=[];readHeader(t){var e=new DataView(t),n=U.Utils.getIntAt(e,0,this.littleEndian),r,a,s,l;if(n!==b.MAGIC_COOKIE&&(this.littleEndian=!0,n=U.Utils.getIntAt(e,0,this.littleEndian)),n!==b.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=U.Utils.getByteAt(e,39),r=0;r<8;r+=1)l=40+r*2,this.dims[r]=U.Utils.getShortAt(e,l,this.littleEndian);for(this.intent_p1=U.Utils.getFloatAt(e,56,this.littleEndian),this.intent_p2=U.Utils.getFloatAt(e,60,this.littleEndian),this.intent_p3=U.Utils.getFloatAt(e,64,this.littleEndian),this.intent_code=U.Utils.getShortAt(e,68,this.littleEndian),this.datatypeCode=U.Utils.getShortAt(e,70,this.littleEndian),this.numBitsPerVoxel=U.Utils.getShortAt(e,72,this.littleEndian),this.slice_start=U.Utils.getShortAt(e,74,this.littleEndian),r=0;r<8;r+=1)l=76+r*4,this.pixDims[r]=U.Utils.getFloatAt(e,l,this.littleEndian);if(this.vox_offset=U.Utils.getFloatAt(e,108,this.littleEndian),this.scl_slope=U.Utils.getFloatAt(e,112,this.littleEndian),this.scl_inter=U.Utils.getFloatAt(e,116,this.littleEndian),this.slice_end=U.Utils.getShortAt(e,120,this.littleEndian),this.slice_code=U.Utils.getByteAt(e,122),this.xyzt_units=U.Utils.getByteAt(e,123),this.cal_max=U.Utils.getFloatAt(e,124,this.littleEndian),this.cal_min=U.Utils.getFloatAt(e,128,this.littleEndian),this.slice_duration=U.Utils.getFloatAt(e,132,this.littleEndian),this.toffset=U.Utils.getFloatAt(e,136,this.littleEndian),this.description=U.Utils.getStringAt(e,148,228),this.aux_file=U.Utils.getStringAt(e,228,252),this.qform_code=U.Utils.getShortAt(e,252,this.littleEndian),this.sform_code=U.Utils.getShortAt(e,254,this.littleEndian),this.quatern_b=U.Utils.getFloatAt(e,256,this.littleEndian),this.quatern_c=U.Utils.getFloatAt(e,260,this.littleEndian),this.quatern_d=U.Utils.getFloatAt(e,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=U.Utils.getFloatAt(e,268,this.littleEndian),this.qoffset_y=U.Utils.getFloatAt(e,272,this.littleEndian),this.qoffset_z=U.Utils.getFloatAt(e,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){let o=this.quatern_a,f=this.quatern_b,u=this.quatern_c,h=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[o*o+f*f-u*u-h*h,2*f*u-2*o*h,2*f*h+2*o*u],[2*f*u+2*o*h,o*o+u*u-f*f-h*h,2*u*h-2*o*f],[2*f*h-2*o*u,2*u*h+2*o*f,o*o+h*h-u*u-f*f]],a=0;a<3;a+=1)for(s=0;s<3;s+=1)this.affine[a][s]=this.quatern_R[a][s]*this.pixDims[s+1],s===2&&(this.affine[a][s]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(a=0;a<3;a+=1)for(s=0;s<4;s+=1)l=280+(a*4+s)*4,this.affine[a][s]=U.Utils.getFloatAt(e,l,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=U.Utils.getStringAt(e,328,344),this.magic=U.Utils.getStringAt(e,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,b.MAGIC_NUMBER2),e.byteLength>b.MAGIC_COOKIE){this.extensionFlag[0]=U.Utils.getByteAt(e,348),this.extensionFlag[1]=U.Utils.getByteAt(e,348+1),this.extensionFlag[2]=U.Utils.getByteAt(e,348+2),this.extensionFlag[3]=U.Utils.getByteAt(e,348+3);let o=!0;!this.isHDR&&this.vox_offset<=352&&(o=!1),e.byteLength<=352+16&&(o=!1),o&&this.extensionFlag[0]&&(this.extensions=U.Utils.getExtensionsAt(e,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var t=U.Utils.formatNumber,e="";return e+="Dim Info = "+this.dim_info+`
`,e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,e+="Intent Code = "+this.intent_code+`
`,e+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,e+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,e+="Slice Start = "+this.slice_start+`
`,e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+`
`,e+="Image Offset = "+this.vox_offset+`
`,e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+`
`,e+="Slice End = "+this.slice_end+`
`,e+="Slice Code = "+this.slice_code+`
`,e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(b.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(b.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+`
`,e+="Slice Duration = "+this.slice_duration+`
`,e+="Time Axis Shift = "+this.toffset+`
`,e+='Description: "'+this.description+`"
`,e+='Auxiliary File: "'+this.aux_file+`"
`,e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+`
`,e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+`
`,e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+`
`,e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+`
`,e+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(e+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),e}getDatatypeCodeString=function(t){return t===b.TYPE_UINT8?"1-Byte Unsigned Integer":t===b.TYPE_INT16?"2-Byte Signed Integer":t===b.TYPE_INT32?"4-Byte Signed Integer":t===b.TYPE_FLOAT32?"4-Byte Float":t===b.TYPE_FLOAT64?"8-Byte Float":t===b.TYPE_RGB24?"RGB":t===b.TYPE_INT8?"1-Byte Signed Integer":t===b.TYPE_UINT16?"2-Byte Unsigned Integer":t===b.TYPE_UINT32?"4-Byte Unsigned Integer":t===b.TYPE_INT64?"8-Byte Signed Integer":t===b.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"};getTransformCodeString=function(t){return t===b.XFORM_SCANNER_ANAT?"Scanner":t===b.XFORM_ALIGNED_ANAT?"Aligned":t===b.XFORM_TALAIRACH?"Talairach":t===b.XFORM_MNI_152?"MNI":"Unknown"};getUnitsCodeString=function(t){return t===b.UNITS_METER?"Meters":t===b.UNITS_MM?"Millimeters":t===b.UNITS_MICRON?"Microns":t===b.UNITS_SEC?"Seconds":t===b.UNITS_MSEC?"Milliseconds":t===b.UNITS_USEC?"Microseconds":t===b.UNITS_HZ?"Hz":t===b.UNITS_PPM?"PPM":t===b.UNITS_RADS?"Rads":"Unknown"};getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(t,e,n,r,a,s,l,o,f,u){var h=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],v,m=t,g=e,p=n,c,y,A;return h[3][0]=h[3][1]=h[3][2]=0,h[3][3]=1,v=1-(m*m+g*g+p*p),v<1e-7?(v=1/Math.sqrt(m*m+g*g+p*p),m*=v,g*=v,p*=v,v=0):v=Math.sqrt(v),c=l>0?l:1,y=o>0?o:1,A=f>0?f:1,u<0&&(A=-A),h[0][0]=(v*v+m*m-g*g-p*p)*c,h[0][1]=2*(m*g-v*p)*y,h[0][2]=2*(m*p+v*g)*A,h[1][0]=2*(m*g+v*p)*c,h[1][1]=(v*v+g*g-m*m-p*p)*y,h[1][2]=2*(g*p-v*m)*A,h[2][0]=2*(m*p-v*g)*c,h[2][1]=2*(g*p+v*m)*y,h[2][2]=(v*v+p*p-g*g-m*m)*A,h[0][3]=r,h[1][3]=a,h[2][3]=s,h}convertNiftiSFormToNEMA(t){var e,n,r,a,s,l,o,f,u,h,v,m,g,p,c,y,A,T,x,R,O,M,d,Y,N,V,z,C,F,G,B,P,k,X;if(c=0,z=[[0,0,0],[0,0,0],[0,0,0]],C=[[0,0,0],[0,0,0],[0,0,0]],e=t[0][0],n=t[0][1],r=t[0][2],a=t[1][0],s=t[1][1],l=t[1][2],o=t[2][0],f=t[2][1],u=t[2][2],h=Math.sqrt(e*e+a*a+o*o),h===0||(e/=h,a/=h,o/=h,h=Math.sqrt(n*n+s*s+f*f),h===0))return null;if(n/=h,s/=h,f/=h,h=e*n+a*s+o*f,Math.abs(h)>1e-4){if(n-=h*e,s-=h*a,f-=h*o,h=Math.sqrt(n*n+s*s+f*f),h===0)return null;n/=h,s/=h,f/=h}if(h=Math.sqrt(r*r+l*l+u*u),h===0?(r=a*f-o*s,l=o*n-f*e,u=e*s-a*n):(r/=h,l/=h,u/=h),h=e*r+a*l+o*u,Math.abs(h)>1e-4){if(r-=h*e,l-=h*a,u-=h*o,h=Math.sqrt(r*r+l*l+u*u),h===0)return null;r/=h,l/=h,u/=h}if(h=n*r+s*l+f*u,Math.abs(h)>1e-4){if(r-=h*n,l-=h*s,u-=h*f,h=Math.sqrt(r*r+l*l+u*u),h===0)return null;r/=h,l/=h,u/=h}if(z[0][0]=e,z[0][1]=n,z[0][2]=r,z[1][0]=a,z[1][1]=s,z[1][2]=l,z[2][0]=o,z[2][1]=f,z[2][2]=u,v=this.nifti_mat33_determ(z),v===0)return null;for(V=-666,x=M=d=Y=1,R=2,O=3,g=1;g<=3;g+=1)for(p=1;p<=3;p+=1)if(g!==p){for(c=1;c<=3;c+=1)if(!(g===c||p===c))for(C[0][0]=C[0][1]=C[0][2]=C[1][0]=C[1][1]=C[1][2]=C[2][0]=C[2][1]=C[2][2]=0,y=-1;y<=1;y+=2)for(A=-1;A<=1;A+=2)for(T=-1;T<=1;T+=2)C[0][g-1]=y,C[1][p-1]=A,C[2][c-1]=T,m=this.nifti_mat33_determ(C),m*v>0&&(N=this.nifti_mat33_mul(C,z),h=N[0][0]+N[1][1]+N[2][2],h>V&&(V=h,x=g,R=p,O=c,M=y,d=A,Y=T))}switch(F=G=B=P=k=X="",x*M){case 1:F="X",P="+";break;case-1:F="X",P="-";break;case 2:F="Y",P="+";break;case-2:F="Y",P="-";break;case 3:F="Z",P="+";break;case-3:F="Z",P="-";break}switch(R*d){case 1:G="X",k="+";break;case-1:G="X",k="-";break;case 2:G="Y",k="+";break;case-2:G="Y",k="-";break;case 3:G="Z",k="+";break;case-3:G="Z",k="-";break}switch(O*Y){case 1:B="X",X="+";break;case-1:B="X",X="-";break;case 2:B="Y",X="+";break;case-2:B="Y",X="-";break;case 3:B="Z",X="+";break;case-3:B="Z",X="-";break}return F+G+B+P+k+X}nifti_mat33_mul=function(t,e){var n=[[0,0,0],[0,0,0],[0,0,0]],r,a;for(r=0;r<3;r+=1)for(a=0;a<3;a+=1)n[r][a]=t[r][0]*e[0][a]+t[r][1]*e[1][a]+t[r][2]*e[2][a];return n};nifti_mat33_determ=function(t){var e,n,r,a,s,l,o,f,u;return e=t[0][0],n=t[0][1],r=t[0][2],a=t[1][0],s=t[1][1],l=t[1][2],o=t[2][0],f=t[2][1],u=t[2][2],e*s*u-e*f*l-a*n*u+a*f*r+o*n*l-o*s*r};getExtensionLocation(){return b.MAGIC_COOKIE+4}getExtensionSize(t){return U.Utils.getIntAt(t,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(t){return U.Utils.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)}addExtension(t,e=-1){e==-1?this.extensions.push(t):this.extensions.splice(e,0,t),this.vox_offset+=t.esize}removeExtension(t){let e=this.extensions[t];e&&(this.vox_offset-=e.esize),this.extensions.splice(t,1)}toArrayBuffer(t=!1){let r=352;if(t)for(let o of this.extensions)r+=o.esize;let a=new Uint8Array(r),s=new DataView(a.buffer);s.setInt32(0,348,this.littleEndian),s.setUint8(39,this.dim_info);for(let o=0;o<8;o++)s.setUint16(40+2*o,this.dims[o],this.littleEndian);s.setFloat32(56,this.intent_p1,this.littleEndian),s.setFloat32(60,this.intent_p2,this.littleEndian),s.setFloat32(64,this.intent_p3,this.littleEndian),s.setInt16(68,this.intent_code,this.littleEndian),s.setInt16(70,this.datatypeCode,this.littleEndian),s.setInt16(72,this.numBitsPerVoxel,this.littleEndian),s.setInt16(74,this.slice_start,this.littleEndian);for(let o=0;o<8;o++)s.setFloat32(76+4*o,this.pixDims[o],this.littleEndian);s.setFloat32(108,this.vox_offset,this.littleEndian),s.setFloat32(112,this.scl_slope,this.littleEndian),s.setFloat32(116,this.scl_inter,this.littleEndian),s.setInt16(120,this.slice_end,this.littleEndian),s.setUint8(122,this.slice_code),s.setUint8(123,this.xyzt_units),s.setFloat32(124,this.cal_max,this.littleEndian),s.setFloat32(128,this.cal_min,this.littleEndian),s.setFloat32(132,this.slice_duration,this.littleEndian),s.setFloat32(136,this.toffset,this.littleEndian),a.set(Buffer.from(this.description),148),a.set(Buffer.from(this.aux_file),228),s.setInt16(252,this.qform_code,this.littleEndian),s.setInt16(254,this.sform_code,this.littleEndian),s.setFloat32(256,this.quatern_b,this.littleEndian),s.setFloat32(260,this.quatern_c,this.littleEndian),s.setFloat32(264,this.quatern_d,this.littleEndian),s.setFloat32(268,this.qoffset_x,this.littleEndian),s.setFloat32(272,this.qoffset_y,this.littleEndian),s.setFloat32(276,this.qoffset_z,this.littleEndian);let l=this.affine.flat();for(let o=0;o<12;o++)s.setFloat32(280+4*o,l[o],this.littleEndian);if(a.set(Buffer.from(this.intent_name),328),a.set(Buffer.from(this.magic),344),t){a.set(Uint8Array.from([1,0,0,0]),348);let o=this.getExtensionLocation();for(let f of this.extensions)s.setInt32(o,f.esize,f.littleEndian),s.setInt32(o+4,f.ecode,f.littleEndian),a.set(new Uint8Array(f.edata),o+8),o+=f.esize}else a.set(new Uint8Array(4).fill(0),348);return a.buffer}},S=b;E(S,"TYPE_NONE",0),E(S,"TYPE_BINARY",1),E(S,"TYPE_UINT8",2),E(S,"TYPE_INT16",4),E(S,"TYPE_INT32",8),E(S,"TYPE_FLOAT32",16),E(S,"TYPE_COMPLEX64",32),E(S,"TYPE_FLOAT64",64),E(S,"TYPE_RGB24",128),E(S,"TYPE_INT8",256),E(S,"TYPE_UINT16",512),E(S,"TYPE_UINT32",768),E(S,"TYPE_INT64",1024),E(S,"TYPE_UINT64",1280),E(S,"TYPE_FLOAT128",1536),E(S,"TYPE_COMPLEX128",1792),E(S,"TYPE_COMPLEX256",2048),E(S,"XFORM_UNKNOWN",0),E(S,"XFORM_SCANNER_ANAT",1),E(S,"XFORM_ALIGNED_ANAT",2),E(S,"XFORM_TALAIRACH",3),E(S,"XFORM_MNI_152",4),E(S,"SPATIAL_UNITS_MASK",7),E(S,"TEMPORAL_UNITS_MASK",56),E(S,"UNITS_UNKNOWN",0),E(S,"UNITS_METER",1),E(S,"UNITS_MM",2),E(S,"UNITS_MICRON",3),E(S,"UNITS_SEC",8),E(S,"UNITS_MSEC",16),E(S,"UNITS_USEC",24),E(S,"UNITS_HZ",32),E(S,"UNITS_PPM",40),E(S,"UNITS_RADS",48),E(S,"MAGIC_COOKIE",348),E(S,"STANDARD_HEADER_SIZE",348),E(S,"MAGIC_NUMBER_LOCATION",344),E(S,"MAGIC_NUMBER",[110,43,49]),E(S,"MAGIC_NUMBER2",[110,105,49]),E(S,"EXTENSION_HEADER_SIZE",8);he.NIFTI1=S});var Be=It(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.NIFTI2=void 0;var tt=ue(),w=jt(),Pt=class{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];magic="0";extensionFlag=[0,0,0,0];extensions=[];extensionSize=0;extensionCode=0;readHeader(t){var e=new DataView(t),n=w.Utils.getIntAt(e,0,this.littleEndian),r,a,s,l,o;if(n!==Pt.MAGIC_COOKIE&&(this.littleEndian=!0,n=w.Utils.getIntAt(e,0,this.littleEndian)),n!==Pt.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=w.Utils.getStringAt(e,4,12),this.datatypeCode=w.Utils.getShortAt(e,12,this.littleEndian),this.numBitsPerVoxel=w.Utils.getShortAt(e,14,this.littleEndian),r=0;r<8;r+=1)l=16+r*8,this.dims[r]=w.Utils.getLongAt(e,l,this.littleEndian);for(this.intent_p1=w.Utils.getDoubleAt(e,80,this.littleEndian),this.intent_p2=w.Utils.getDoubleAt(e,88,this.littleEndian),this.intent_p3=w.Utils.getDoubleAt(e,96,this.littleEndian),r=0;r<8;r+=1)l=104+r*8,this.pixDims[r]=w.Utils.getDoubleAt(e,l,this.littleEndian);for(this.vox_offset=w.Utils.getLongAt(e,168,this.littleEndian),this.scl_slope=w.Utils.getDoubleAt(e,176,this.littleEndian),this.scl_inter=w.Utils.getDoubleAt(e,184,this.littleEndian),this.cal_max=w.Utils.getDoubleAt(e,192,this.littleEndian),this.cal_min=w.Utils.getDoubleAt(e,200,this.littleEndian),this.slice_duration=w.Utils.getDoubleAt(e,208,this.littleEndian),this.toffset=w.Utils.getDoubleAt(e,216,this.littleEndian),this.slice_start=w.Utils.getLongAt(e,224,this.littleEndian),this.slice_end=w.Utils.getLongAt(e,232,this.littleEndian),this.description=w.Utils.getStringAt(e,240,240+80),this.aux_file=w.Utils.getStringAt(e,320,320+24),this.qform_code=w.Utils.getIntAt(e,344,this.littleEndian),this.sform_code=w.Utils.getIntAt(e,348,this.littleEndian),this.quatern_b=w.Utils.getDoubleAt(e,352,this.littleEndian),this.quatern_c=w.Utils.getDoubleAt(e,360,this.littleEndian),this.quatern_d=w.Utils.getDoubleAt(e,368,this.littleEndian),this.qoffset_x=w.Utils.getDoubleAt(e,376,this.littleEndian),this.qoffset_y=w.Utils.getDoubleAt(e,384,this.littleEndian),this.qoffset_z=w.Utils.getDoubleAt(e,392,this.littleEndian),a=0;a<3;a+=1)for(s=0;s<4;s+=1)l=400+(a*4+s)*8,this.affine[a][s]=w.Utils.getDoubleAt(e,l,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=w.Utils.getIntAt(e,496,this.littleEndian),this.xyzt_units=w.Utils.getIntAt(e,500,this.littleEndian),this.intent_code=w.Utils.getIntAt(e,504,this.littleEndian),this.intent_name=w.Utils.getStringAt(e,508,508+16),this.dim_info=w.Utils.getByteAt(e,524),e.byteLength>Pt.MAGIC_COOKIE&&(this.extensionFlag[0]=w.Utils.getByteAt(e,540),this.extensionFlag[1]=w.Utils.getByteAt(e,540+1),this.extensionFlag[2]=w.Utils.getByteAt(e,540+2),this.extensionFlag[3]=w.Utils.getByteAt(e,540+3),this.extensionFlag[0]&&(this.extensions=w.Utils.getExtensionsAt(e,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var t=w.Utils.formatNumber,e="";return e+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,e+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+`
`,e+="Image Offset = "+this.vox_offset+`
`,e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+`
`,e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+`
`,e+="Slice Duration = "+this.slice_duration+`
`,e+="Time Axis Shift = "+this.toffset+`
`,e+="Slice Start = "+this.slice_start+`
`,e+="Slice End = "+this.slice_end+`
`,e+='Description: "'+this.description+`"
`,e+='Auxiliary File: "'+this.aux_file+`"
`,e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+`
`,e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+`
`,e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+`
`,e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+`
`,e+="Slice Code = "+this.slice_code+`
`,e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(tt.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(tt.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,e+="Intent Code = "+this.intent_code+`
`,e+='Intent Name: "'+this.intent_name+`"
`,e+="Dim Info = "+this.dim_info+`
`,e}getExtensionLocation=function(){return Pt.MAGIC_COOKIE+4};getExtensionSize=tt.NIFTI1.prototype.getExtensionSize;getExtensionCode=tt.NIFTI1.prototype.getExtensionCode;addExtension=tt.NIFTI1.prototype.addExtension;removeExtension=tt.NIFTI1.prototype.removeExtension;getDatatypeCodeString=tt.NIFTI1.prototype.getDatatypeCodeString;getTransformCodeString=tt.NIFTI1.prototype.getTransformCodeString;getUnitsCodeString=tt.NIFTI1.prototype.getUnitsCodeString;getQformMat=tt.NIFTI1.prototype.getQformMat;convertNiftiQFormToNiftiSForm=tt.NIFTI1.prototype.convertNiftiQFormToNiftiSForm;convertNiftiSFormToNEMA=tt.NIFTI1.prototype.convertNiftiSFormToNEMA;nifti_mat33_mul=tt.NIFTI1.prototype.nifti_mat33_mul;nifti_mat33_determ=tt.NIFTI1.prototype.nifti_mat33_determ;toArrayBuffer(t=!1){let r=544;if(t)for(let o of this.extensions)r+=o.esize;let a=new Uint8Array(r),s=new DataView(a.buffer);s.setInt32(0,540,this.littleEndian),a.set(Buffer.from(this.magic),4),s.setInt16(12,this.datatypeCode,this.littleEndian),s.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let o=0;o<8;o++)s.setBigInt64(16+8*o,BigInt(this.dims[o]),this.littleEndian);s.setFloat64(80,this.intent_p1,this.littleEndian),s.setFloat64(88,this.intent_p2,this.littleEndian),s.setFloat64(96,this.intent_p3,this.littleEndian);for(let o=0;o<8;o++)s.setFloat64(104+8*o,this.pixDims[o],this.littleEndian);s.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),s.setFloat64(176,this.scl_slope,this.littleEndian),s.setFloat64(184,this.scl_inter,this.littleEndian),s.setFloat64(192,this.cal_max,this.littleEndian),s.setFloat64(200,this.cal_min,this.littleEndian),s.setFloat64(208,this.slice_duration,this.littleEndian),s.setFloat64(216,this.toffset,this.littleEndian),s.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),s.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),a.set(Buffer.from(this.description),240),a.set(Buffer.from(this.aux_file),320),s.setInt32(344,this.qform_code,this.littleEndian),s.setInt32(348,this.sform_code,this.littleEndian),s.setFloat64(352,this.quatern_b,this.littleEndian),s.setFloat64(360,this.quatern_c,this.littleEndian),s.setFloat64(368,this.quatern_d,this.littleEndian),s.setFloat64(376,this.qoffset_x,this.littleEndian),s.setFloat64(384,this.qoffset_y,this.littleEndian),s.setFloat64(392,this.qoffset_z,this.littleEndian);let l=this.affine.flat();for(let o=0;o<12;o++)s.setFloat64(400+8*o,l[o],this.littleEndian);if(s.setInt32(496,this.slice_code,this.littleEndian),s.setInt32(500,this.xyzt_units,this.littleEndian),s.setInt32(504,this.intent_code,this.littleEndian),a.set(Buffer.from(this.intent_name),508),s.setUint8(524,this.dim_info),t){a.set(Uint8Array.from([1,0,0,0]),540);let o=this.getExtensionLocation();for(let f of this.extensions)s.setInt32(o,f.esize,f.littleEndian),s.setInt32(o+4,f.ecode,f.littleEndian),a.set(new Uint8Array(f.edata),o+8),o+=f.esize}else a.set(new Uint8Array(4).fill(0),540);return a.buffer}},At=Pt;E(At,"MAGIC_COOKIE",540),E(At,"MAGIC_NUMBER_LOCATION",4),E(At,"MAGIC_NUMBER",[110,43,50,0,13,10,26,10]),E(At,"MAGIC_NUMBER2",[110,105,50,0,13,10,26,10]);ce.NIFTI2=At});var dn=It(q=>{var en=q&&q.__createBinding||(Object.create?function(i,t,e,n){n===void 0&&(n=e);var r=Object.getOwnPropertyDescriptor(t,e);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(i,n,r)}:function(i,t,e,n){n===void 0&&(n=e),i[n]=t[e]}),nn=q&&q.__setModuleDefault||(Object.create?function(i,t){Object.defineProperty(i,"default",{enumerable:!0,value:t})}:function(i,t){i.default=t}),rn=q&&q.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)e!=="default"&&Object.prototype.hasOwnProperty.call(i,e)&&en(t,i,e);return nn(t,i),t};Object.defineProperty(q,"__esModule",{value:!0});q.readExtensionData=q.readExtension=q.readImage=q.hasExtension=q.readHeader=q.decompress=q.isCompressed=q.isNIFTI=q.isNIFTI2=q.isNIFTI1=q.NIFTIEXTENSION=q.Utils=q.NIFTI2=q.NIFTI1=void 0;var sn=rn(Ci()),at=ue(),ct=Be(),wi=jt(),an=ue();Object.defineProperty(q,"NIFTI1",{enumerable:!0,get:function(){return an.NIFTI1}});var on=Be();Object.defineProperty(q,"NIFTI2",{enumerable:!0,get:function(){return on.NIFTI2}});var ln=jt();Object.defineProperty(q,"Utils",{enumerable:!0,get:function(){return ln.Utils}});var fn=Oe();Object.defineProperty(q,"NIFTIEXTENSION",{enumerable:!0,get:function(){return fn.NIFTIEXTENSION}});function Pe(i,t=!1){var e,n,r,a;return i.byteLength<at.NIFTI1.STANDARD_HEADER_SIZE?!1:(e=new DataView(i),e&&(n=e.getUint8(at.NIFTI1.MAGIC_NUMBER_LOCATION)),r=e.getUint8(at.NIFTI1.MAGIC_NUMBER_LOCATION+1),a=e.getUint8(at.NIFTI1.MAGIC_NUMBER_LOCATION+2),t&&n===at.NIFTI1.MAGIC_NUMBER2[0]&&r===at.NIFTI1.MAGIC_NUMBER2[1]&&a===at.NIFTI1.MAGIC_NUMBER2[2]?!0:n===at.NIFTI1.MAGIC_NUMBER[0]&&r===at.NIFTI1.MAGIC_NUMBER[1]&&a===at.NIFTI1.MAGIC_NUMBER[2])}q.isNIFTI1=Pe;function be(i,t=!1){var e,n,r,a;return i.byteLength<at.NIFTI1.STANDARD_HEADER_SIZE?!1:(e=new DataView(i),n=e.getUint8(ct.NIFTI2.MAGIC_NUMBER_LOCATION),r=e.getUint8(ct.NIFTI2.MAGIC_NUMBER_LOCATION+1),a=e.getUint8(ct.NIFTI2.MAGIC_NUMBER_LOCATION+2),t&&n===ct.NIFTI2.MAGIC_NUMBER2[0]&&r===ct.NIFTI2.MAGIC_NUMBER2[1]&&a===ct.NIFTI2.MAGIC_NUMBER2[2]?!0:n===ct.NIFTI2.MAGIC_NUMBER[0]&&r===ct.NIFTI2.MAGIC_NUMBER[1]&&a===ct.NIFTI2.MAGIC_NUMBER[2])}q.isNIFTI2=be;function hn(i,t=!1){return Pe(i,t)||be(i,t)}q.isNIFTI=hn;function Ni(i){var t,e,n;return!!(i&&(t=new DataView(i),e=t.getUint8(0),n=t.getUint8(1),e===wi.Utils.GUNZIP_MAGIC_COOKIE1||n===wi.Utils.GUNZIP_MAGIC_COOKIE2))}q.isCompressed=Ni;function Fi(i){return sn.decompressSync(new Uint8Array(i)).buffer}q.decompress=Fi;function un(i,t=!1){var e=null;return Ni(i)&&(i=Fi(i)),Pe(i,t)?e=new at.NIFTI1:be(i,t)&&(e=new ct.NIFTI2),e?e.readHeader(i):console.error("That file does not appear to be NIFTI!"),e}q.readHeader=un;function cn(i){return i.extensionFlag[0]!=0}q.hasExtension=cn;function vn(i,t){var e=i.vox_offset,n=1,r=1;i.dims[4]&&(n=i.dims[4]),i.dims[5]&&(r=i.dims[5]);var a=i.dims[1]*i.dims[2]*i.dims[3]*n*r*(i.numBitsPerVoxel/8);return t.slice(e,e+a)}q.readImage=vn;function gn(i,t){var e=i.getExtensionLocation(),n=i.extensionSize;return t.slice(e,e+n)}q.readExtension=gn;function pn(i,t){var e=i.getExtensionLocation(),n=i.extensionSize;return t.slice(e+8,e+n)}q.readExtensionData=pn});dn();})();
